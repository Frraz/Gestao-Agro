<!-- /src/templates/layouts/auditoria.html -->

{% extends "layouts/base.html" %}
{% block title %}Painel de Auditoria{% endblock %}
{% block content %}
<h2>Painel de Auditoria</h2>
<div class="table-responsive">
  <table class="table table-striped table-bordered align-middle">
    <thead>
      <tr>
        <th>Data/Hora</th>
        <th>Usuário</th>
        <th>Ação</th>
        <th>Entidade</th>
        <th>Valor Anterior</th>
        <th>Valor Novo</th>
      </tr>
    </thead>
    <tbody>
      {% for log in logs %}
      <tr>
        <td>{{ log.data_hora.strftime('%d/%m/%Y %H:%M:%S') }}</td>
        <td>{{ log.usuario.nome if log.usuario else '---' }}</td>
        <td>{{ log.acao }}</td>
        <td>{{ log.entidade }}</td>
        <td>
          {% if log.valor_anterior %}
            <pre style="white-space: pre-wrap; word-break: break-all;">{{ log.valor_anterior|tojson(indent=2, sort_keys=True) if log.valor_anterior is string else log.valor_anterior }}</pre>
          {% else %}
            -
          {% endif %}
        </td>
        <td>
          {% if log.valor_novo %}
            <pre style="white-space: pre-wrap; word-break: break-all;">{{ log.valor_novo|tojson(indent=2, sort_keys=True) if log.valor_novo is string else log.valor_novo }}</pre>
          {% else %}
            -
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}